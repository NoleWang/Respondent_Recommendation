[16:11] <5a0d62aed73408ce4f7ed9b2> @adrinjalali Hi, thanks for your advice. Here is my code: ``` import numpy as np from sklearn.pipeline import Pipeline from sklearn.preprocessing import MinMaxScaler from sklearn.compose import TransformedTargetRegressor from sklearn.neighbors import KNeighborsRegressor from sklearn.model_selection import GridSearchCV  target_scaler = MinMaxScaler() estimator = Pipeline([         ('scaler', MinMaxScaler()),         ('model', TransformedTargetRegressor(           KNeighborsRegressor(metric='precomputed'),           transformer=target_scaler         ))])  grid_params = {'model__regressor__n_neighbors': [3, 5, 7]} scoring = 'accuracy' clf = GridSearchCV(estimator, param_grid=grid_params,                        scoring=scoring,                        cv=5, return_train_score=True, refit=True,                        error_score='raise')  D_app = np.random.rand(10, 10) y_app = np.random.rand(10) clf.fit(D_app, y_app) ``` The following error is raised: ``` File "/media/ljia/DATA/research-repo/projects/202110 Redox/codes/Redox/issues/target_scaling.py", line 34, in <module>     clf.fit(D_app, y_app)    File "/home/ljia/.local/lib/python3.8/site-packages/sklearn/model_selection/_search.py", line 891, in fit     self._run_search(evaluate_candidates)    File "/home/ljia/.local/lib/python3.8/site-packages/sklearn/model_selection/_search.py", line 1392, in _run_search     evaluate_candidates(ParameterGrid(self.param_grid))    File "/home/ljia/.local/lib/python3.8/site-packages/sklearn/model_selection/_search.py", line 838, in evaluate_candidates     out = parallel(    File "/home/ljia/.local/lib/python3.8/site-packages/joblib/parallel.py", line 1043, in __call__     if self.dispatch_one_batch(iterator):    File "/home/ljia/.local/lib/python3.8/site-packages/joblib/parallel.py", line 861, in dispatch_one_batch     self._dispatch(tasks)    File "/home/ljia/.local/lib/python3.8/site-packages/joblib/parallel.py", line 779, in _dispatch     job = self._backend.apply_async(batch, callback=cb)    File "/home/ljia/.local/lib/python3.8/site-packages/joblib/_parallel_backends.py", line 208, in apply_async     result = ImmediateResult(func)    File "/home/ljia/.local/lib/python3.8/site-packages/joblib/_parallel_backends.py", line 572, in __init__     self.results = batch()    File "/home/ljia/.local/lib/python3.8/site-packages/joblib/parallel.py", line 262, in __call__     return [func(*args, **kwargs)    File "/home/ljia/.local/lib/python3.8/site-packages/joblib/parallel.py", line 262, in <listcomp>     return [func(*args, **kwargs)    File "/home/ljia/.local/lib/python3.8/site-packages/sklearn/utils/fixes.py", line 211, in __call__     return self.function(*args, **kwargs)    File "/home/ljia/.local/lib/python3.8/site-packages/sklearn/model_selection/_validation.py", line 681, in _fit_and_score     estimator.fit(X_train, y_train, **fit_params)    File "/home/ljia/.local/lib/python3.8/site-packages/sklearn/pipeline.py", line 394, in fit     self._final_estimator.fit(Xt, y, **fit_params_last_step)    File "/home/ljia/.local/lib/python3.8/site-packages/sklearn/compose/_target.py", line 246, in fit     self.regressor_.fit(X, y_trans, **fit_params)    File "/home/ljia/.local/lib/python3.8/site-packages/sklearn/neighbors/_regression.py", line 213, in fit     return self._fit(X, y)    File "/home/ljia/.local/lib/python3.8/site-packages/sklearn/neighbors/_base.py", line 489, in _fit     raise ValueError(  ValueError: Precomputed matrix must be square. Input is a 8x10 matrix. ``` May I ask what may be the problem? In case it is not supported, are there other ways to correctly scale targets in GridSearchCV (as well as HalvingGridSearchCV, etc.)? Thank you very much!
--------------------------------------------------------------------------------------------------
